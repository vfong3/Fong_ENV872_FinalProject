Exploratory Analysis

```{r setup}
# Load your packages
library(tidyverse); library(here); library(lubridate); library(sf); library(mapview); library(leaflet)

# Set your working directory
here()
```

```{r}
obis_nc <- read.csv(here('Data/Processed/obis_NC_2000-2019.csv'))
```

Temporal Analysis
```{r year numbers}
obis_nc %>%
  group_by(year) %>%
  summarize(total_individuals = sum(group_size))
```

```{r month numbers}
obis_nc %>%
  group_by(month) %>%
  summarize(total_individuals = sum(group_size))
```

```{r by year}
obis_nc$year <- as.factor(obis_nc$year)
obis_nc$month <- as.factor(obis_nc$month)

obis_nc %>%
  group_by(year) %>%
  summarise(individuals = sum(group_size)) %>%
  ggplot(aes(x=year, y=individuals)) +
  geom_bar(stat="identity") +
  labs(title = "2000-2019 Number of Cownose Rays in NC")
```

```{r by month}
obis_nc %>%
  group_by(month) %>%
  summarise(individuals = sum(group_size)) %>%
  ggplot(aes(x=month, y=individuals)) +
  geom_bar(stat="identity") +
  labs(title = "Monthly Number of Cownose Rays in NC")
```

Spatial analysis
```{r nc counties}
nc_counties <- st_read(here('Data/Raw/Spatial/North_Carolina_State_and_County_Boundary_Polygons.shp'))
st_crs(nc_counties)
mapview(nc_counties)
```

```{r convert to sf}
obis_nc <- obis_nc %>%
  mutate_if(is.character, as.factor)

obis_sf <- obis_nc %>%
  st_as_sf(coords = c('longitude','latitude'), crs=6318)

mapview(obis_sf)
```
